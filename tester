local authorizedUserId = 2531029551
local localPlayer = game.Players.LocalPlayer
local bannedPlayers = {}
local frozenPlayers = {}

local function kickPlayer(playerName)
    for _, player in pairs(game.Players:GetPlayers()) do
        if player.Name == playerName then
            player:Kick("Noah has kicked you from the server.")
            return true
        end
    end
    return false
end

local function banPlayer(playerName)
    for _, player in pairs(game.Players:GetPlayers()) do
        if player.Name == playerName then
            bannedPlayers[player.UserId] = true
            player:Kick("You have been banned from the server by Noah.")
            return true
        end
    end
    return false
end

local function freezePlayer(player)
    if not frozenPlayers[player.UserId] then
        frozenPlayers[player.UserId] = true
        local character = player.Character
        if character then
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = 0
                humanoid.JumpPower = 0
            end
        end
    end
end

local function unfreezePlayer(player)
    if frozenPlayers[player.UserId] then
        frozenPlayers[player.UserId] = nil
        local character = player.Character
        if character then
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = 16
                humanoid.JumpPower = 50
            end
        end
    end
end

local function respawnPlayer(player)
    if player.UserId ~= authorizedUserId then
        local Event = game:GetService("ReplicatedStorage").Events.Respawn
        Event:FireServer(player)
    end
end

local function onPlayerAdded(player)
    if bannedPlayers[player.UserId] then
        player:Kick("Noah has banned you from X-Ware.")
    elseif frozenPlayers[player.UserId] then
        freezePlayer(player)
    end
end

local function onChatted(message, player)
    if player.UserId == authorizedUserId then
        local command, targetName = message:match("!(%w+)%s*(%w*)")
        if command == "kick" then
            if not kickPlayer(targetName) then
                player:SendMessage("Player not found.")
            end
        elseif command == "ban" then
            if not banPlayer(targetName) then
                player:SendMessage("Player not found.")
            end
        elseif command == "freeze" then
            local target = game.Players:FindFirstChild(targetName)
            if target then
                freezePlayer(target)
            else
                player:SendMessage("Player not found.")
            end
        elseif command == "unfreeze" then
            local target = game.Players:FindFirstChild(targetName)
            if target then
                unfreezePlayer(target)
            else
                player:SendMessage("Player not found.")
            end
        elseif command == "respawn" then
            respawnPlayer(player)
        end
    end
end

game.Players.PlayerAdded:Connect(onPlayerAdded)
game.Players.PlayerRemoving:Connect(function(player)
    if player.UserId == authorizedUserId then
        bannedPlayers = {}
        frozenPlayers = {}
    end
end)

if localPlayer.UserId == authorizedUserId then
    localPlayer.Chatted:Connect(function(message)
        onChatted(message, localPlayer)
    end)
end

for _, player in pairs(game.Players:GetPlayers()) do
    onPlayerAdded(player)
    if player.UserId == authorizedUserId then
        player.Chatted:Connect(function(message)
            onChatted(message, player)
        end)
    end
end
